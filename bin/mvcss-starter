#!/usr/bin/env bash
# ****************************************************
#
#   MVCSS Starter
#   -> Creates an MVCSS starter application using drewbarontini/baseman
#
# ----------------------------------------------------
#   Dependencies
# ----------------------------------------------------
#
#  - comment
#  - download-zip
#
# ****************************************************

set -o errexit
set -o nounset
set -o pipefail

# ----------------------------------------------------
#   Variables
# ----------------------------------------------------

BASEMANURL='git@github.com:drewbarontini/baseman.git'

# ----------------------------------------------------
#   Main
# ----------------------------------------------------

printf '\n'
comment l 'MVCSS Starter Project'
printf '\n'

comment m 'Cloning drewbarontini/baseman...'
printf '\n'
git clone "$BASEMANURL" "$1"
cd "$1"

printf '\n'
comment m 'Cleaning up repo...'
printf '\n'
message green 'Cleaned up repo!'
rm CHANGELOG.md
rm MIT-LICENSE

printf '\n'
comment m 'Downloading MVCSS...'
printf '\n'
cd source/assets/stylesheets
download-zip 'https://github.com/mvcss/mvcss/archive/master.zip'
message green 'Downloaded MVCSS!'
mv mvcss-master/application.sass application.sass
mv mvcss-master/foundation foundation
mv mvcss-master/components components
mv mvcss-master/structures structures
rm -rf mvcss-master

printf '\n'
comment m 'Setting up a new Git repo...'
printf '\n'
cd ../../../
rm -rf .git
git init
git add .
git commit -m 'Initial commit'
printf '\n'
message green 'Set up new Git repo with initial commit!'

printf '\n'
comment m 'Bundling...'
printf '\n'
gem install bundler
bundle install --binstubs

printf '\n'
comment m 'Starting the Middleman server...'
printf '\n'
bundle exec middleman s
